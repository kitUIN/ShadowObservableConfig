<Page
    x:Class="Config.WinUI.EmojiConfigPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:winUi="using:Config.WinUI"
    mc:Ignorable="d"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <ScrollViewer>
        <StackPanel Margin="20" Spacing="20">
            <!-- 页面标题 -->
            <TextBlock Text="Emoji 插件配置" 
                       Style="{StaticResource TitleTextBlockStyle}"
                       HorizontalAlignment="Center"
                       Margin="0,0,0,20"/>

            <!-- 默认表情大小 -->
            <StackPanel>
                <TextBlock Text="默认表情大小" 
                           Style="{StaticResource BodyTextBlockStyle}"
                           Margin="0,0,0,8"/>
                <Slider x:Name="DefaultEmojiSizeSlider"
                        Minimum="16"
                        Maximum="128"
                        Value="{x:Bind ViewModel.DefaultEmojiSize, Mode=TwoWay}"
                        TickFrequency="8"
                        TickPlacement="BottomRight" />
                <TextBlock Text="{x:Bind ViewModel.DefaultEmojiSize, Mode=OneWay}"
                           Style="{StaticResource CaptionTextBlockStyle}"
                           HorizontalAlignment="Right"
                           Margin="0,4,0,0"/>
            </StackPanel>

            <!-- 启用自动完成 -->
            <StackPanel>
                <TextBlock Text="启用自动完成" 
                           Style="{StaticResource BodyTextBlockStyle}"
                           Margin="0,0,0,8"/>
                <ToggleSwitch x:Name="EnableAutoCompleteToggle"
                              IsOn="{x:Bind ViewModel.EnableAutoComplete, Mode=TwoWay}"
                              OnContent="启用"
                              OffContent="禁用"/>
            </StackPanel>

            <!-- 最大表情历史记录数 -->
            <StackPanel>
                <TextBlock Text="最大表情历史记录数" 
                           Style="{StaticResource BodyTextBlockStyle}"
                           Margin="0,0,0,8"/>
                <NumberBox x:Name="MaxEmojiHistoryNumberBox"
                           Value="{x:Bind ViewModel.MaxEmojiHistory, Mode=TwoWay}"
                           Minimum="10"
                           Maximum="1000"
                           SpinButtonPlacementMode="Inline"
                           Width="200"
                           HorizontalAlignment="Left"/>
            </StackPanel>

            <!-- 默认肤色 -->
            <StackPanel>
                <TextBlock Text="默认肤色" 
                           Style="{StaticResource BodyTextBlockStyle}"
                           Margin="0,0,0,8"/>
                <ComboBox x:Name="DefaultSkinToneComboBox"
                          SelectedItem="{x:Bind ViewModel.DefaultSkinTone, Mode=TwoWay}"
                          Width="200"
                          HorizontalAlignment="Left">
                    <x:String>default</x:String>
                    <x:String>light</x:String>
                    <x:String>medium</x:String>
                    <x:String>dark</x:String>
                </ComboBox>
            </StackPanel>

            <!-- 动画速度 -->
            <StackPanel>
                <TextBlock Text="动画速度" 
                           Style="{StaticResource BodyTextBlockStyle}"
                           Margin="0,0,0,8"/>
                <Slider x:Name="AnimationSpeedSlider"
                        Minimum="0.1"
                        Maximum="3.0"
                        Value="{x:Bind ViewModel.AnimationSpeed, Mode=TwoWay}"
                        TickFrequency="0.1"
                        TickPlacement="BottomRight" 
                        StepFrequency="0.1"/>
                <TextBlock Text="{x:Bind ViewModel.AnimationSpeed, Mode=OneWay}"
                           Style="{StaticResource CaptionTextBlockStyle}"
                           HorizontalAlignment="Right"
                           Margin="0,4,0,0"/>
            </StackPanel>

            <!-- 分隔线 -->
            <Border Height="1" Background="{ThemeResource SystemControlBackgroundBaseLowBrush}" Margin="0,10"/>

            <!-- 嵌套设置标题 -->
            <TextBlock Text="表情设置" 
                       Style="{StaticResource SubtitleTextBlockStyle}"
                       Margin="0,0,0,10"/>

            <!-- 嵌套值 -->
            <StackPanel>
                <TextBlock Text="嵌套值" 
                           Style="{StaticResource BodyTextBlockStyle}"
                           Margin="0,0,0,8"/>
                <TextBox x:Name="NestedValueTextBox"
                         Text="{x:Bind ViewModel.Settings.NestedValue, Mode=TwoWay}"
                         Width="300"
                         HorizontalAlignment="Left"
                         PlaceholderText="请输入嵌套值"/>
            </StackPanel>

            <!-- 嵌套数字 -->
            <StackPanel>
                <TextBlock Text="嵌套数字" 
                           Style="{StaticResource BodyTextBlockStyle}"
                           Margin="0,0,0,8"/>
                <NumberBox x:Name="NestedNumberNumberBox"
                           Value="{x:Bind ViewModel.Settings.NestedNumber, Mode=TwoWay}"
                           Minimum="0"
                           Maximum="9999"
                           SpinButtonPlacementMode="Inline"
                           Width="200"
                           HorizontalAlignment="Left"/>
            </StackPanel>

            <!-- 嵌套布尔值 -->
            <StackPanel>
                <TextBlock Text="嵌套布尔值" 
                           Style="{StaticResource BodyTextBlockStyle}"
                           Margin="0,0,0,8"/>
                <ToggleSwitch x:Name="NestedBooleanToggle"
                              IsOn="{x:Bind ViewModel.Settings.NestedBoolean, Mode=TwoWay}"
                              OnContent="是"
                              OffContent="否"/>
            </StackPanel>

            <!-- 分隔线 -->
            <Border Height="1" Background="{ThemeResource SystemControlBackgroundBaseLowBrush}" Margin="0,10"/>

            <!-- 收藏表情标题 -->
            <TextBlock Text="收藏表情" 
                       Style="{StaticResource SubtitleTextBlockStyle}"
                       Margin="0,0,0,10"/>

            <!-- 收藏表情列表 -->
            <StackPanel>
                <StackPanel Orientation="Horizontal" Spacing="10" Margin="0,0,0,8">
                    <TextBox x:Name="NewEmojiTextBox"
                             Width="200"
                             PlaceholderText="输入要添加的表情"/>
                    <Button x:Name="AddEmojiButton"
                            Content="添加表情"
                            Click="AddEmojiButton_Click"/>
                </StackPanel>
                <ListView x:Name="FavoriteEmojisListView"
                          ItemsSource="{x:Bind ViewModel.FavoriteEmojis, Mode=OneWay}"
                          Height="150"
                          SelectionMode="Single">
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal" Spacing="10">
                                <TextBlock Text="{Binding}" 
                                           Style="{StaticResource BodyTextBlockStyle}"
                                           VerticalAlignment="Center"/>
                                <Button Content="删除"
                                        Click="RemoveEmojiButton_Click"
                                        Tag="{Binding}"
                                        Padding="8,4"/>
                            </StackPanel>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </StackPanel>

            <!-- 分隔线 -->
            <Border Height="1" Background="{ThemeResource SystemControlBackgroundBaseLowBrush}" Margin="0,10"/>

            <!-- 自定义设置标题 -->
            <TextBlock Text="自定义设置" 
                       Style="{StaticResource SubtitleTextBlockStyle}"
                       Margin="0,0,0,10"/>

            <!-- 自定义设置列表 -->
            <StackPanel>
                <Button x:Name="AddCustomSettingButton"
                        Content="添加自定义设置"
                        Click="AddCustomSettingButton_Click"
                        HorizontalAlignment="Left"
                        Margin="0,0,0,8"/>
                <ListView x:Name="CustomSettingsListView"
                          ItemsSource="{x:Bind ViewModel.CustomSettings, Mode=OneWay}"
                          Height="200"
                          SelectionMode="Single">
                    <ListView.ItemTemplate>
                        <DataTemplate x:DataType="winUi:NestedSettings">
                            <StackPanel Spacing="8" Margin="8">
                                <StackPanel Orientation="Horizontal" Spacing="10">
                                    <TextBlock Text="嵌套值:" 
                                               Style="{StaticResource CaptionTextBlockStyle}"
                                               VerticalAlignment="Center"/>
                                    <TextBox Text="{x:Bind NestedValue, Mode=TwoWay}"
                                             Width="150"
                                             PlaceholderText="嵌套值"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" Spacing="10">
                                    <TextBlock Text="嵌套数字:" 
                                               Style="{StaticResource CaptionTextBlockStyle}"
                                               VerticalAlignment="Center"/>
                                    <NumberBox Value="{x:Bind NestedNumber, Mode=TwoWay}"
                                               Width="100"
                                               Minimum="0"
                                               Maximum="9999"
                                               SpinButtonPlacementMode="Inline"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" Spacing="10">
                                    <TextBlock Text="嵌套布尔值:" 
                                               Style="{StaticResource CaptionTextBlockStyle}"
                                               VerticalAlignment="Center"/>
                                    <ToggleSwitch IsOn="{x:Bind NestedBoolean, Mode=TwoWay}"
                                                  OnContent="是"
                                                  OffContent="否"/>
                                    <Button Content="删除"
                                            Click="RemoveCustomSettingButton_Click"
                                            Tag="{Binding}"
                                            Padding="8,4"/>
                                </StackPanel>
                            </StackPanel>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </StackPanel>

            <!-- 操作按钮 -->
            <StackPanel Orientation="Horizontal" 
                        HorizontalAlignment="Center" 
                        Spacing="20"
                        Margin="0,30,0,0">
                <Button x:Name="SaveButton"
                        Content="保存配置"
                        Click="SaveButton_Click"/>
                <Button x:Name="ResetButton"
                        Content="重置为默认"
                        Click="ResetButton_Click"/>
                <Button x:Name="LoadButton"
                        Content="重新加载"
                        Click="LoadButton_Click"/>
            </StackPanel>

            <!-- 状态信息 -->
            <TextBlock x:Name="StatusTextBlock"
                       Style="{StaticResource CaptionTextBlockStyle}"
                       HorizontalAlignment="Center"
                       Foreground="{ThemeResource SystemAccentColor}"
                       Margin="0,10,0,0"/>
        </StackPanel>
    </ScrollViewer>
</Page>
